const themes = {
  cyan: {
    color: '#00F1FF', 
    image: '',
    emojis: {
      yes: '<:checkcircle:1412739663155957841>',
      no: '<:no:1412739688266993715>',
      info: '<:info:1412739678049927209>',
      limit: "<:elearning:1412739669501677579>",
      camoff: "<:novideo:1412739690892886167>",
      camon: "<:videocamera:1412744085181038696>",
      hide: "<:hidden1:1412739674417664091>",
      show: "<:visible1:1412739708559167598>",
      permit: "<:addfriend:1412739659745722418>",
      reject: "<:removefriend:1412739697859493990>",
      lock: "<:lock1:1412739681170489354>",
      unlock: "<:lockopen:1412739684144255016>",
      transfer: "<:refresh:1412739694705508412>",
      owner: "<:crown:1412744801920745514>",
      top: "",
      sb: "<:sound:1412739701495828522>",
      activity: "",
      name: "<:edit:1412739666322653214>",
      help: ""
    },
    footer: 'Cyan Theme',
  },
  gold: {
    color: '#F6DC43',
    image: '',
    emojis: {
      yes: '<:checkcircle1:1412741054695735356>',
      no: '<:no1:1412741082055311469>',
      info: '<:info1:1412741075113742417>',
      limit: "<:elearning1:1412741066746237008>",
      camoff: "<:novideo1:1412741084907311114>",
      camon: "<:videocamera1:1412745886773153844>",
      hide: "<:hidden:1412741070957182987>",
      show: "<:visible:1412741099449225276>",
      permit: "<:addfriend1:1412741050627260527>",
      reject: "<:removefriend1:1412741092025040937>",
      lock: "<:lock:1412741102229913650>",
      unlock: "<:lockopen1:1412741078091825303>",
      transfer: "<:refresh1:1412741088317276261>",
      owner: "<:crown:1412741059351416903>",
      top: "",
      sb: "<:sound1:1412741095372230663>",
      activity: "",
      name: "<:edit1:1412741063462092881>",
      help: ""
    },
    footer: 'Gold Theme', 
  },
  pink: {
    color: '#FD00FF',
    image: '',
    emojis: {
      yes: '<:checkcircle2:1412741431696687145>',
      no: '<:no2:1412741464097820672>',
      info: '<:info2:1412741445537759352>',
      limit: "<:elearning2:1412741437828632680>",
      camoff: "<:novideo2:1412741466119471124>",
      camon: "<:videocamera:1412741480757461124>",
      hide: "<:hidden2:1412741442182447215>",
      show: "<:visible2:1412741484368625786>",
      permit: "<:addfriend2:1412741428248973463>",
      reject: "<:removefriend2:1412741473182679110>",
      lock: "<:lock3:1412741456027979868>",
      unlock: "<:lockopen2:1412741459353796740>",
      transfer: "<:refresh2:1412741469562863689>",
      owner: "<:crown1:1412741434573852702>",
      top: "",
      sb: "<:sound2:1412741477422989383>",
      activity: "",
      name: "<:edit1:1412752374216392745>",
      help: ""
    },
    footer: 'Pink Theme',
  },
  gray: {
    color: '#A4A4A4',
    image: '',
    emojis: {
      yes: '<:checkcircle3:1412741690384449598>',
      no: '<:no3:1412741716082950214>',
      info: '<:info1:1412741707090493542>',
      limit: "<:elearning3:1412741699066925137>",
      camoff: "<:novideo3:1412741719564488774>",
      camon: "<:videocamera1:1412741732541661184>",
      hide: "<:hidden3:1412741703630065696>",
      show: "<:visible3:1412741737281224775>",
      permit: "<:addfriend3:1412741686781542440>",
      reject: "<:removefriend3:1412741726086496287>",
      lock: "<:lock4:1412741709456211988>",
      unlock: "<:lockopen3:1412741712539029514>",
      transfer: "<:refresh3:1412741723305803860>",
      owner: "<:crown2:1412741693253484585>",
      top: "",
      sb: "<:sound3:1412741728959729755>",
      activity: "",
      name: "<:edit2:1412741695912804352>",
      help: ""
    },
    footer: 'Gray Theme'
  },
  black: {
    color: '#000000', 
    image: '',
    emojis: {
      yes: '<:checkcircle4:1412741964478021709>',
      no: '<:no4:1412741990944215060>',
      info: '<:info8:1412741981612015659>',
      limit: "<:elearning8:1412741976029134848>",
      camoff: "<:novideo1:1412755195670040616>",
      camon: "<:videocamera4:1412742001857921145>",
      hide: "<:hidden4:1412741978906427464>",
      show: "<:visible8:1412742004919762964>",
      permit: "<:addfriend8:1412741961764573316>",
      reject: "<:removefriend8:1412741996392747008>",
      lock: "<:lock5:1412741984233193492>",
      unlock: "<:lockopen5:1412741987370532894>",
      transfer: "<:refresh8:1412741993918103562>",
      owner: "<:crown6:1412741968827514940>",
      top: "",
      sb: "<:sound8:1412741999320236132>",
      activity: "",
      name: "<:edit7:1412741971327451206>",
      help: ""
    },
    footer: 'Black Theme',
  },
  green: {
    color: '#00FA15',
    image: '',
    emojis: {
      yes: '<:checkcircle5:1412742223790870588>',
      no: '<:no5:1412742255046819920>',
      info: '<:info4:1412742246125801502>',
      limit: "<:elearning4:1412742239159062528>",
      camoff: "<:novideo4:1412742257488035951>",
      camon: "<:videocamera2:1412742275066495036>",
      hide: "<:hidden5:1412742242602455050>",
      show: "<:visible4:1412742278241320990>",
      permit: "<:elearning4:1412742239159062528>",
      reject: "<:removefriend4:1412742265285378089>",
      lock: "<:lock6:1412742249179250688>",
      unlock: "<:lockopen4:1412742251662016532>",
      transfer: "<:refresh4:1412742261124501535>",
      owner: "<:crown3:1412742226504843304>",
      top: "",
      sb: "<:sound4:1412742272881262611>",
      activity: "",
      name: "<:edit3:1412742235858141284>",
      help: ""
    },
    footer: 'Green Theme',
  },
  white: {
    color: '#FFFAFF',
    image: 'https://cdn.discordapp.com/attachments/1439729095452790815/1441747608921182251/Gemini_Generated_Image_etgh6netgh6netgh.png?ex=6922eb98&is=69219a18&hm=76a0bfdc7ac8cbb21e3d3417deb75d0f61019326baf82e85493bd022c1c93431&',
    emojis: {
      yes: '<:checkcircle6:1412742487734358126>',
      no: '<:no7:1412742513319477308>',
      info: '<:info5:1412742503689359400>',
      limit: "<:elearning5:1412742496508842004>",
      camoff: "<:novideo5:1412742516540964864>",
      camon: "<:videocamera3:1412742528704450651>",
      hide: "<:hidden6:1412742500128526406>",
      show: "<:visible5:1412742531736666192>",
      permit: "<:addfriend5:1412742476753666059>",
      reject: "<:removefriend5:1412742522131972126>",
      lock: "<:lock7:1412742506348548237>",
      unlock: "<:lockopen6:1412742509649596476>",
      transfer: "<:refresh5:1412742519627845703>",
      owner: "<:crown4:1412742490800525362>",
      top: "",
      sb: "<:sound5:1412742525923365036>",
      activity: "",
      name: "<:edit4:1412742493736407082>",
      help: ""
    },
    footer: 'White Theme',
  },
  red: {
    color: '#FA2900',
    image: '',
    emojis: {
      yes: '<:checkcircle7:1412742761311895634>',
      no: '<:no6:1412742788994568202>',
      info: '<:info6:1412742778378649712>',
      limit: "<:elearning6:1412742769910480957>",
      camoff: "<:novideo6:1412742791468945439>",
      camon: "<:videocamera5:1412742805020872704>",
      hide: "<:hidden7:1412742773714452531>",
      show: "<:visible6:1412742808942411907>",
      permit: "<:addfriend6:1412742754588688477>",
      reject: "<:removefriend6:1412742798675021874>",
      lock: "<:lock8:1412742781792813086>",
      unlock: "<:lockopen7:1412742785311838258>",
      transfer: "<:refresh6:1412742795202138122>",
      owner: "<:crown7:1412742764390518805>",
      top: "",
      sb: "<:sound6:1412742801594126338>",
      activity: "",
      name: "<:edit5:1412742767314079834>",
      help: ""
    },
    footer: 'Red Theme',
  },
  purple: {
    color: '#B300FA',
    image: '',
    emojis: {
      yes: '<:checkcircle8:1412743020129812540>',
      no: '<:no8:1412743046910705724>',
      info: '<:info7:1412743036017840262>',
      limit: "<:elearning7:1412743029269205103>",
      camoff: "<:novideo7:1412743050425274480>",
      camon: "<:videocamera6:1412743063855435897>",
      hide: "<:hidden8:1412743032935026778>",
      show: "<:visible7:1412743067286372393>",
      permit: "<:addfriend7:1412743016807927899>",
      reject: "<:removefriend7:1412743058063364218>",
      lock: "<:lock9:1412743039377473536>",
      unlock: "<:lockopen8:1412743042976321586>",
      transfer: "<:refresh7:1412743054313521152>",
      owner: "<:crown5:1412743022827012166>",
      top: "",
      sb: "<:sound7:1412743061410287618>",
      activity: "",
      name: "<:edit6:1412743025624616992>",
      help: ""
    },
    footer: 'Purple Theme',
  },
};

module.exports = {
themes,
async getTheme(guildId) {
  const GuildConfig = require('../models/GuildConfig');
  const config = await GuildConfig.findOne({ guildId });
  return themes[config?.theme || 'White'];
},


async setTheme(guildId, theme) {
  const GuildConfig = require('../models/GuildConfig');
  await GuildConfig.findOneAndUpdate(
    { guildId },
    { theme },
    { upsert: true, new: true },
  );
},


applyThemeToEmbed(embed, theme) {
  embed.setColor(theme.color).setFooter({ text: theme.footer });
  return embed;
},


async getEmoji(guildId, type) {
  const theme = await this.getTheme(guildId);
  return theme.emojis[type] || '‚ùì';
},

// Return a CDN URL for a themed emoji with a desired size (for big display)
async getEmojiUrl(guildId, type, size = 256) {
  const tag = await this.getEmoji(guildId, type);
  return emojiToUrl(tag, size);
},
};

// --- Helpers ---
// Convert a custom emoji tag like "<:name:123>" or "<a:name:123>" to a CDN URL
function emojiToUrl(tag, size = 256) {
if (typeof tag !== 'string') return null;
const match = tag.match(/^<(?:(a):)?[^:]*:(\d+)>$/);
if (!match) return null; // Not a custom emoji tag
const animated = !!match[1];
const id = match[2];
const ext = animated ? 'gif' : 'png';
const validSize = Number.isInteger(size) ? Math.min(Math.max(size, 16), 4096) : 256;
return `https://cdn.discordapp.com/emojis/${id}.${ext}?size=${validSize}&quality=lossless`;
}

module.exports.emojiToUrl = emojiToUrl;